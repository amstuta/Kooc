#!/usr/bin/env python

import os
import cnorm
from misc import *
from kooc_class import *


def main():
    inFile, outFile = check_argv()
    create_header()
    a = Kooc()
    res = a.parse_file(inFile)
    add_include(res)
    """
    if 'Object' in DeclKeeper.instance().modules:
        del DeclKeeper.instance().modules['Object']
    """
    if 'Object' in decl_keeper.modules:
        del decl_keeper.modules['Object']
    moduleTransfo(res)
    if outFile.endswith('.h'):
        add_defines(res, outFile)

    #for i in res.body:
    #    if hasattr(i, '_name') and 'izi' in i._name:
    #        print(i)

    write_file_out(outFile, res)
    return 0
    
    
if __name__ == '__main__':
    main()
